<app-header (toggleSidebar)="toggleSidebar()"></app-header>

<div class="dashboard-wrapper" [class.sidebar-hidden]="isSidebarHidden">
  <app-sidenav [isSidebarHidden]="isSidebarHidden"></app-sidenav>

  <main class="main-content">
    <section class="table-wrapper">

      <!-- Search -->
      <div class="dashboard-control-bar d-flex justify-content-between align-items-center mb-3"
          style="gap:1rem; padding-top:2em;">

        <input
          type="text"
          pInputText
          placeholder="Search Job | Serial | WC"
          [(ngModel)]="globalSearch"
          (input)="onGlobalSearch()"
          class="form-control rounded-pill"
          style="max-width:400px;"

        />

        <button class="btn btn-success" (click)="exportToExcel()">
          <i class="fa fa-file-excel"></i> Export
        </button>

        <button class="btn btn-primary"
          [disabled]="!selectedJobs.length"
          (click)="startSelectedJobs()">
          â–¶ Start Selected ({{ selectedJobs.length }})
        </button>


      </div>


      <!-- Table -->
      <div class="card p-1 mt-3 shadow-sm">
        <div class="card-body p-1">

          <p-table
              #dt
              [value]="filteredTransactions"
              [(selection)]="selectedJobs"
              dataKey="id"
              sortMode="multiple"
              [paginator]="true"
              [rows]="5000"
              [scrollable]="true"
              scrollHeight="500px"
              [loading]="isLoading"
            >
              <ng-template pTemplate="header">
                <tr>
                  <th style="background-color: #ECC391;">
                    <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                  </th>

                  <th style="background-color: #ECC391;">S.No</th>
                  <th pSortableColumn="jobNumber" style="background-color: #ECC391;">
                    Job <p-sortIcon field="jobNumber"></p-sortIcon>
                  </th>

                  <th pSortableColumn="serialNo" style="background-color: #ECC391;">
                    Serial No <p-sortIcon field="serialNo"></p-sortIcon>
                  </th>

                  <th pSortableColumn="operationNumber" style="background-color: #ECC391;">
                    Opr No <p-sortIcon field="operationNumber"></p-sortIcon>
                  </th>
                  <th pSortableColumn="item" style="background-color: #ECC391;">
                    Item <p-sortIcon field="item"></p-sortIcon> 
                  </th>
                  <th style="background-color: #ECC391;">Qty</th>
                  
                  <th style="background-color: #ECC391;">Action</th>
                </tr>
              </ng-template>

              <ng-template pTemplate="body" let-job let-rowIndex="rowIndex">
                <tr>
                  <td>
                    <p-tableCheckbox [value]="job"></p-tableCheckbox>
                  </td>

                  <td>{{ rowIndex + 1 }}</td>
                  <td>{{ job.jobNumber }}</td>
                  <td>{{ job.serialNo }}</td>
                  <td>{{ job.operationNumber }}</td>
                  <td>{{ job.item }}</td>
                  <td>{{ job.qtyReleased }}</td>
                 

                  <td>
                    <button class="btn btn-success btn-sm"
                      (click)="startIssueJob(job)">
                      Start
                    </button>
                  </td>
                </tr>
              </ng-template>
            </p-table>


        </div>
      </div>

    </section>
  </main>
</div>
